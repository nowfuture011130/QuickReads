{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport { globalStyles } from \"../styles/global\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Bookmark(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    bookmark = _useState2[0],\n    setBookmark = _useState2[1];\n  var accessToken = global.id;\n  var root = \"http://quickreads-env.eba-nmhvwvfp.us-east-1.elasticbeanstalk.com\";\n  var submitHandler = function submitHandler(text) {\n    setBookmark(function (preText) {\n      return [text].concat(_toConsumableArray(preText));\n    });\n  };\n  var deleteHandler = function deleteHandler() {\n    setBookmark(function (preText) {\n      return [];\n    });\n  };\n  var deleteBookmark = function deleteBookmark(text) {\n    removeFromBackend(text);\n    setBookmark(function (preText) {\n      return preText.filter(function (i) {\n        return i.url != text.url;\n      });\n    });\n  };\n  function removeFromBackend(_x) {\n    return _removeFromBackend.apply(this, arguments);\n  }\n  function _removeFromBackend() {\n    _removeFromBackend = _asyncToGenerator(function* (item) {\n      var body = {\n        id: accessToken,\n        url: item.url\n      };\n      try {\n        var response = yield fetch(root + \"/removebookmarkpost\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(body)\n        });\n        if (!response.ok) {\n          throw new Error(\"Request failed with status \" + response.status);\n        }\n      } catch (error) {\n        console.error(\"Error occurred:\", error.message);\n      }\n    });\n    return _removeFromBackend.apply(this, arguments);\n  }\n  function refreshBookmark() {\n    return _refreshBookmark.apply(this, arguments);\n  }\n  function _refreshBookmark() {\n    _refreshBookmark = _asyncToGenerator(function* () {\n      console.log(root + \"/getBookmarks/\" + accessToken);\n      var articleRequest = yield fetch(root + \"/getBookmarks/\" + accessToken, {\n        method: \"GET\"\n      }).then(function (response) {\n        return response.json();\n      }).then(function (responseJSON) {\n        console.log(responseJSON);\n        deleteHandler();\n        for (var key in responseJSON) {\n          submitHandler({\n            url: responseJSON[key][\"url\"]\n          });\n        }\n      }).catch();\n    });\n    return _refreshBookmark.apply(this, arguments);\n  }\n  useEffect(function () {\n    refreshBookmark();\n  }, []);\n  if (bookmark.length == 0) {\n    return _jsx(View, {\n      style: globalStyles.container,\n      children: _jsx(Text, {\n        style: globalStyles.titleText,\n        children: \"You don't have any article in bookmark, please add some.\"\n      })\n    });\n  }\n  return _jsx(View, {\n    style: globalStyles.container,\n    children: _jsx(FlatList, {\n      data: bookmark,\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item;\n        return _jsxs(View, {\n          children: [_jsx(AntDesign, {\n            name: \"delete\",\n            color: \"#444\",\n            size: 18,\n            onPress: function onPress() {\n              console.log(\"delete \" + item.url);\n              deleteBookmark(item);\n            }\n          }), _jsx(TouchableOpacity, {\n            style: globalStyles.homeText,\n            onPress: function onPress() {\n              Linking.openURL(item.url);\n            },\n            children: item.url\n          })]\n        });\n      },\n      ItemSeparatorComponent: function ItemSeparatorComponent() {\n        return _jsx(View, {\n          style: {\n            height: 30\n          }\n        });\n      }\n    })\n  });\n}","map":{"version":3,"names":["React","useState","useEffect","View","Text","FlatList","TouchableOpacity","Linking","StyleSheet","Button","TextInput","Alert","TouchableWithoutFeedback","Keyboard","globalStyles","AntDesign","jsx","_jsx","jsxs","_jsxs","Bookmark","_ref","navigation","_useState","_useState2","_slicedToArray","bookmark","setBookmark","accessToken","global","id","root","submitHandler","text","preText","concat","_toConsumableArray","deleteHandler","deleteBookmark","removeFromBackend","filter","i","url","_x","_removeFromBackend","apply","arguments","_asyncToGenerator","item","body","response","fetch","method","headers","JSON","stringify","ok","Error","status","error","console","message","refreshBookmark","_refreshBookmark","log","articleRequest","then","json","responseJSON","key","catch","length","style","container","children","titleText","data","renderItem","_ref2","name","color","size","onPress","homeText","openURL","ItemSeparatorComponent","height"],"sources":["/Users/haoranwu/Documents/GitHub/QuickReads2/frontend/screens/Bookmark.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  Text,\n  FlatList,\n  TouchableOpacity,\n  Linking,\n  StyleSheet,\n  Button,\n  TextInput,\n  Alert,\n  TouchableWithoutFeedback,\n  Keyboard,\n} from \"react-native\";\nimport { globalStyles } from \"../styles/global\";\nimport { AntDesign } from \"@expo/vector-icons\";\nexport default function Bookmark({ navigation }) {\n  const [bookmark, setBookmark] = useState(\"\"); //user's bookmark\n  let accessToken = global.id; // Save global.id as accessToken\n  const root =\n    \"http://quickreads-env.eba-nmhvwvfp.us-east-1.elasticbeanstalk.com\";\n  /* add new bookmark to user's bookmark */\n  const submitHandler = (text) => {\n    setBookmark((preText) => {\n      return [text, ...preText];\n    });\n  };\n  /* clear user's bookmark */\n  const deleteHandler = () => {\n    setBookmark((preText) => {\n      return [];\n    });\n  };\n  /* delete specific bookmark from user's bookmark and backend's database */\n  const deleteBookmark = (text) => {\n    removeFromBackend(text);\n    setBookmark((preText) => {\n      return preText.filter((i) => i.url != text.url);\n    });\n  };\n  /* delete specific bookmark from backend */\n  async function removeFromBackend(item) {\n    const body = { id: accessToken, url: item.url };\n    try {\n      const response = await fetch(root + \"/removebookmarkpost\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(body),\n      });\n      if (!response.ok) {\n        throw new Error(`Request failed with status ${response.status}`);\n      }\n    } catch (error) {\n      console.error(\"Error occurred:\", error.message);\n    }\n  }\n\n  /* get all bookmarks form backend and add in user's bookmark */\n  async function refreshBookmark() {\n    console.log(root + \"/getBookmarks/\" + accessToken);\n    const articleRequest = await fetch(root + \"/getBookmarks/\" + accessToken, {\n      method: \"GET\",\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((responseJSON) => {\n        console.log(responseJSON);\n        deleteHandler();\n        for (var key in responseJSON) {\n          submitHandler({\n            url: responseJSON[key][\"url\"],\n          });\n        }\n      })\n      .catch();\n  }\n  /* every time visit bookmark page, refresh shown bookmark */\n  useEffect(() => {\n    refreshBookmark();\n  }, []);\n  //if user has no bookmark\n  if (bookmark.length == 0) {\n    return (\n      <View style={globalStyles.container}>\n        <Text style={globalStyles.titleText}>\n          You don't have any article in bookmark, please add some.\n        </Text>\n      </View>\n    );\n  }\n\n  return (\n    <View style={globalStyles.container}>\n      <FlatList\n        data={bookmark}\n        renderItem={({ item }) => (\n          <View>\n            {/* show delete icon */}\n            <AntDesign\n              name={\"delete\"}\n              color={\"#444\"}\n              size={18}\n              onPress={() => {\n                console.log(\"delete \" + item.url);\n                deleteBookmark(item);\n              }}\n            />\n            {/* show bookmark url */}\n            <TouchableOpacity\n              style={globalStyles.homeText}\n              onPress={() => {\n                Linking.openURL(item.url);\n              }}\n            >\n              {item.url}\n            </TouchableOpacity>\n          </View>\n        )}\n        ItemSeparatorComponent={() => <View style={{ height: 30 }} />}\n      />\n    </View>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}